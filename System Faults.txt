<form script="table_row_highlighting.js" stylesheet="table_decorations.css" theme="dark">
  <label>System Fault</label>
  <search>
    <query>| inputlookup mso_site_details | dedup apic_host | table apic_host | eval apic_host="apic_host!=".apic_host | mvcombine apic_host | eval apic_host=mvjoin(apic_host, " AND ")</query>
    <earliest>-24h@h</earliest>
    <latest>now</latest>
    <done>
      <condition>
        <set token="not_search_apic_host">$result.apic_host$</set>
      </condition>
    </done>
  </search>
  <search>
    <query>| inputlookup mso_site_details | dedup mso_host | table mso_host</query>
    <earliest>-24h@h</earliest>
    <latest>now</latest>
    <done>
      <condition match="'job.resultCount'==0">
        <unset token="hide_filter"></unset>
        <set token="non_mso_filter">non_mso_filter</set>
        <set token="apic_host_query">eventtype="cisco_apic_*" component=credentials | fields apic_host | dedup apic_host | SORT apic_host</set>
      </condition>
      <condition>
        <set token="hide_filter">hide_filter</set>
      </condition>
    </done>
  </search>
  <search>
    <query>| inputlookup mso_site_details | search mso_host=$mso_host$ | dedup apic_host | table apic_host | eval apic_host="apic_host=".apic_host | mvcombine apic_host | eval apic_host=mvjoin(apic_host, " OR ")</query>
    <earliest>-24h@h</earliest>
    <latest>now</latest>
    <done>
      <condition match="'job.resultCount'&gt;0">
        <set token="search_apic_host">$result.apic_host$</set>
      </condition>
    </done>
  </search>
  <fieldset autoRun="true" submitButton="false">
    <input type="time" searchWhenChanged="true" token="time_token">
      <label>Time Picker</label>
      <default>
        <earliest>-7d@h</earliest>
        <latest>now</latest>
      </default>
    </input>
    <input type="dropdown" token="apic_host" searchWhenChanged="true">
      <label>APIC Sites/Cluster</label>
      <selectFirstChoice>true</selectFirstChoice>
      <search>
        <done>
          <condition match="job.resultCount==0">
            <unset token="formed_apic_host"></unset>
          </condition>
        </done>
        <query>(index::666666-cli sourcetype::faultInfo) | fields apic_ip_address | dedup apic_ip_address</query>
        <earliest>$time_token.earliest$</earliest>
        <latest>$time_token.latest$</latest>
      </search>
      <fieldForLabel>apic_ip_address</fieldForLabel>
      <fieldForValue>apic_ip_address</fieldForValue>
      <choice value="*">All</choice>
      <change>
        <condition match="$value$==&quot;all&quot; AND $non_mso_filter$==&quot;non_mso_filter&quot; AND $mso_host$==&quot;non_mso_sites&quot;">
          <set token="formed_apic_host">apic_host=*</set>
        </condition>
        <condition match="$value$==&quot;all&quot; AND $mso_host$==&quot;non_mso_sites&quot;">
          <set token="formed_apic_host">$not_search_apic_host$</set>
        </condition>
        <condition value="all">
          <set token="formed_apic_host">$search_apic_host$</set>
        </condition>
        <condition>
          <set token="formed_apic_host">apic_host=$apic_host$</set>
        </condition>
      </change>
    </input>
    <input type="multiselect" token="multiTokenQuery" searchWhenChanged="true">
      <default>*</default>
      <label>Severity</label>
      <choice value="*">All</choice>
      <choice value="critical">critical</choice>
      <choice value="major">major</choice>
      <choice value="minor">minor</choice>
      <choice value="warning">warning</choice>
      <choice value="cleared">cleared</choice>
      <delimiter> OR severity=</delimiter>
      <change>
        <eval token="severity_value_token">"form.severity=" . replace(mvjoin($form.multiTokenQuery$,","),",","&amp;form.severity=")</eval>
      </change>
    </input>
  </fieldset>
  <row>
    <panel>
      <html id="role">
        <h3>APIC User Role Privileges</h3>
       <div>APIC user role required: 'Admin' role privilege is required for this dashboard.</div>
     </html>
    </panel>
  </row>
  <row>
    <panel>
      <title>Dashboard Overview</title>
      <html id="overview">
       <p>This dashboard summarizes all of the faults generated by APIC over the time period specified using the time picker. The severity level can also be filtered such that less-important events are not shown.</p>
     </html>
    </panel>
    <panel>
      <single id="faults">
        <title>Faults</title>
        <search>
          <query>(index::666666-cli sourcetype::faultInfo) | search apic_ip_address=$apic_host$ severity=$multiTokenQuery$ | stats count</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="drilldown">all</option>
        <option name="field">count</option>
        <option name="height">135</option>
        <option name="rangeColors">["0x53a051","0x0877a6","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="refresh.display">progressbar</option>
        <drilldown>
          <set token="TotalFault">totalfault</set>
          <unset token="AckFault"></unset>
          <unset token="UnackFault"></unset>
        </drilldown>
      </single>
    </panel>
    <panel>
      <single id="ack">
        <title>Acknowledged Faults</title>
        <search>
          <query>(index::666666-cli sourcetype::faultInfo) | search apic_ip_address=$apic_host$ severity=$multiTokenQuery$ | fields ack deviceId apic_ip_address | search (ack="yes") | stats count</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="drilldown">all</option>
        <option name="field">count</option>
        <option name="refresh.display">progressbar</option>
        <drilldown>
          <set token="AckFault">ackfault</set>
          <unset token="TotalFault"></unset>
          <unset token="UnackFault"></unset>
        </drilldown>
      </single>
    </panel>
    <panel>
      <single id="Unack">
        <title>Unacknowledged Faults</title>
        <search>
          <query>(index::666666-cli sourcetype::faultInfo) | search apic_ip_address=$apic_host$ severity=$multiTokenQuery$ |fields ack deviceId apic_ip_address | search (ack="no") | stats count</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="drilldown">all</option>
        <option name="field">count</option>
        <option name="refresh.display">progressbar</option>
        <drilldown>
          <set token="UnackFault">unackfault</set>
          <unset token="AckFault"></unset>
          <unset token="TotalFault"></unset>
        </drilldown>
      </single>
    </panel>
  </row>
  <row>
    <panel>
      <table id="totalfaultdetail" depends="$TotalFault$">
        <title>Total faults detail</title>
        <search>
          <query>(index::666666-cli sourcetype::faultInfo) | eval NPtime=_time+57600 | eval NPtime=_time+57600 | eval NPtime=strftime(NPtime, "%Y-%m-%d %H:%M:%S") | search apic_ip_address=$apic_host$ severity=$multiTokenQuery$ | rename ack AS acknowledged | rex field=dn "^(?&lt;uni&gt;.+?)\/(?&lt;tenantid&gt;.+?)\/(?&lt;other&gt;\w+)" | rename tenantid AS tenantId descr AS description created AS timeStamp | fields acknowledged code NPtime node tenantId deviceId severity domain apic_ip_address timeStamp cause description |  fields - _raw _time</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="count">10</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">true</option>
        <option name="wrap">false</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <table id="ackfaultdetail" depends="$AckFault$">
        <title>Acknowledged faults detail</title>
        <search>
          <query>(index::666666-cli sourcetype::faultInfo) | eval NPtime=_time+57600 | eval NPtime=strftime(NPtime, "%Y-%m-%d %H:%M:%S") | rename ack AS acknowledged | search acknowledged="yes" apic_ip_address=$apic_host$ severity=$multiTokenQuery$ | rex field=dn "^(?&lt;uni&gt;.+?)\/(?&lt;tenantid&gt;.+?)\/(?&lt;other&gt;\w+)" | rename tenantid AS tenantId descr AS description created AS timeStamp | fields acknowledged code NPtime node tenantId deviceId severity domain apic_ip_address timeStamp cause description |  fields - _raw _time</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="count">10</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">true</option>
        <option name="wrap">false</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <table id="unackfaultdetail" depends="$UnackFault$">
        <title>Unacknowleged faults Detail</title>
        <search>
          <query>(index::666666-cli sourcetype::faultInfo) | eval NPtime=_time+57600 | eval NPtime=strftime(NPtime, "%Y-%m-%d %H:%M:%S") | rename ack AS acknowledged | search acknowledged="no" apic_ip_address=$apic_host$ severity=$multiTokenQuery$ | rex field=dn "^(?&lt;uni&gt;.+?)\/(?&lt;tenantid&gt;.+?)\/(?&lt;other&gt;\w+)" | rename tenantid AS tenantId descr AS description created AS timeStamp | fields acknowledged code NPtime node tenantId deviceId severity domain apic_ip_address timeStamp cause description |  fields - _raw _time</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="count">10</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">true</option>
        <option name="wrap">false</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <chart>
        <title>Faults by Node</title>
        <search>
          <query>(index::666666-cli sourcetype::faultInfo) | search apic_ip_address=$apic_host$ severity=$multiTokenQuery$ | fields ack affected dn apic_ip_address deviceId severity node | stats count(dn) by node</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.chart">pie</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.showDataLabels">none</option>
        <option name="charting.layout.splitSeries.allowIndependentYRanges">0</option>
        <option name="charting.seriesColors">[0x6050DC,0xD52DB7,0xFF2E7E,0xFF6B45,0xFFAB05]</option>
        <drilldown>
          <set token="faultsbyNode">$click.value$</set>
          <unset token="faultsbyTenant"></unset>
          <unset token="faultsbySeverity"></unset>
          <unset token="faultsbyDomain"></unset>
          <unset token="faultsbyCause"></unset>
          <unset token="faultsbyType"></unset>
          <unset token="faultsbyRule"></unset>
        </drilldown>
      </chart>
    </panel>
    <panel>
      <chart>
        <title>Faults by Tenant</title>
        <search>
          <query>(index::666666-cli sourcetype::faultInfo) | search apic_ip_address=$apic_host$ severity=$multiTokenQuery$ | fields ack affected dn apic_ip_address deviceId severity | rex field=dn "^(?&lt;uni&gt;.+?)\/(?&lt;tenantid&gt;.+?)\/(?&lt;other&gt;\w+)" | search uni="uni" | stats count(dn) by tenantid</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">pie</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.showDataLabels">none</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.layout.splitSeries.allowIndependentYRanges">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
        <option name="refresh.display">progressbar</option>
        <option name="charting.seriesColors">[0x6050DC,0xD52DB7,0xFF2E7E,0xFF6B45,0xFFAB05]</option>
        <drilldown target="Help Desk Fault Detail">
          <set token="faultsbyTenant">$click.value$</set>
          <unset token="faultsbyNode"></unset>
          <unset token="faultsbySeverity"></unset>
          <unset token="faultsbyDomain"></unset>
          <unset token="faultsbyCause"></unset>
          <unset token="faultsbyType"></unset>
          <unset token="faultsbyRule"></unset>
        </drilldown>
      </chart>
    </panel>
    <panel>
      <chart>
        <title>Faults by Severity</title>
        <search>
          <query>(index::666666-cli sourcetype::faultInfo) | search apic_ip_address=$apic_host$ severity=$multiTokenQuery$ | fields ack affected dn apic_ip_address deviceId severity| stats count(dn) by severity</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">pie</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.showDataLabels">none</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.layout.splitSeries.allowIndependentYRanges">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
        <option name="refresh.display">progressbar</option>
        <option name="charting.fieldColors">{"cleared":0xD78B85,"warning":0xFF8A73,"minor":0xFF573D,"major":0xFF1919,"critical":0xD60000}</option>
        <drilldown target="Help Desk Fault Detail">
          <set token="faultsbySeverity">$click.value$</set>
          <unset token="faultsbyNode"></unset>
          <unset token="faultsbyTenant"></unset>
          <unset token="faultsbyDomain"></unset>
          <unset token="faultsbyCause"></unset>
          <unset token="faultsbyType"></unset>
          <unset token="faultsbyRule"></unset>
        </drilldown>
      </chart>
    </panel>
    <panel>
      <chart>
        <title>Faults by Domain</title>
        <search>
          <query>(index::666666-cli sourcetype::faultInfo) | search apic_ip_address=$apic_host$ severity=$multiTokenQuery$ | fields ack affected dn apic_ip_address deviceId severity domain | stats count(dn) by domain</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">pie</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.showDataLabels">none</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.layout.splitSeries.allowIndependentYRanges">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
        <option name="refresh.display">progressbar</option>
        <option name="charting.seriesColors">[0x52D726,0xFFEC00,0xFF7300,0xFF0000,0x007ED6,0x7CDDDD]</option>
        <drilldown target="Help Desk Fault Detail">
          <set token="faultsbyDomain">$click.value$</set>
          <unset token="faultsbyNode"></unset>
          <unset token="faultsbyTenant"></unset>
          <unset token="faultsbySeverity"></unset>
          <unset token="faultsbyCause"></unset>
          <unset token="faultsbyType"></unset>
          <unset token="faultsbyRule"></unset>
        </drilldown>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <table id="highlight" depends="$faultsbyNode$">
        <title>Faults by Node Detail</title>
        <search>
          <query>(index::666666-cli sourcetype::faultInfo)| eval NPtime=_time+57600 | eval NPtime=strftime(NPtime, "%Y-%m-%d %H:%M:%S") | rename ack AS acknowledged | search node=$faultsbyNode$ apic_ip_address=$apic_host$ severity=$multiTokenQuery$ | rex field=dn "^(?&lt;uni&gt;.+?)\/(?&lt;tenantid&gt;.+?)\/(?&lt;other&gt;\w+)" | rename tenantid AS tenantId descr AS description created AS timeStamp | fields code NPtime node tenantId deviceId severity domain apic_ip_address timeStamp acknowledged cause description |  fields - _raw _time</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="count">10</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">true</option>
        <option name="wrap">false</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <table id="highlightone" depends="$faultsbyTenant$">
        <title>Faults by Tenant Detail</title>
        <search>
          <query>(index::666666-cli sourcetype::faultInfo) | eval NPtime=_time+57600 | eval NPtime=strftime(NPtime, "%Y-%m-%d %H:%M:%S") | rename ack AS acknowledged | rex field=dn "^(?&lt;uni&gt;.+?)\/(?&lt;tenantid&gt;.+?)\/(?&lt;other&gt;\w+)" | rename tenantid AS tenantId descr AS description created AS timeStamp | fields code NPtime node tenantId deviceId severity domain apic_ip_address timeStamp acknowledged cause description |  fields - _raw _time | search apic_ip_address=$apic_host$ severity=$multiTokenQuery$ tenantId=$faultsbyTenant$</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="count">10</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">true</option>
        <option name="wrap">true</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <table id="highlighttwo" depends="$faultsbySeverity$">
        <title>Faults by Severity Detail</title>
        <search>
          <query>(index::666666-cli sourcetype::faultInfo) | eval NPtime=_time+57600 | eval NPtime=strftime(NPtime, "%Y-%m-%d %H:%M:%S") | rename ack AS acknowledged | search  severity=$faultsbySeverity$ apic_ip_address=$apic_host$ severity=$multiTokenQuery$ | rex field=dn "^(?&lt;uni&gt;.+?)\/(?&lt;tenantid&gt;.+?)\/(?&lt;other&gt;\w+)" | rename tenantid AS tenantId descr AS description created AS timeStamp | fields code NPtime node tenantId deviceId severity domain apic_ip_address timeStamp acknowledged cause description |  fields - _raw _time</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="count">10</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">true</option>
        <option name="wrap">true</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <table id="highlightthree" depends="$faultsbyDomain$">
        <title>Faults by Domain Detail</title>
        <search>
          <query>(index::666666-cli sourcetype::faultInfo) | eval NPtime=_time+57600 | eval NPtime=strftime(NPtime, "%Y-%m-%d %H:%M:%S") | rename ack AS acknowledged | search  domain=$faultsbyDomain$ apic_ip_address=$apic_host$ severity=$multiTokenQuery$ | rex field=dn "^(?&lt;uni&gt;.+?)\/(?&lt;tenantid&gt;.+?)\/(?&lt;other&gt;\w+)" | rename tenantid AS tenantId descr AS description created AS timeStamp | fields code NPtime node tenantId deviceId severity domain apic_ip_address timeStamp acknowledged cause description |  fields - _raw _time</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="count">10</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">true</option>
        <option name="wrap">true</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <chart>
        <title>Faults by Type</title>
        <search>
          <query>(index::666666-cli sourcetype::faultInfo) | search apic_ip_address=$apic_host$ severity=$multiTokenQuery$ | stats count(dn) by type | rename count(dn) as "Faults"</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.text">Faults</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">bar</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.showDataLabels">none</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.layout.splitSeries.allowIndependentYRanges">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
        <option name="refresh.display">progressbar</option>
        <drilldown>
          <set token="faultsbyType">$click.value$</set>
          <unset token="faultsbyNode"></unset>
          <unset token="faultsbyTenant"></unset>
          <unset token="faultsbySeverity"></unset>
          <unset token="faultsbyDomain"></unset>
          <unset token="faultsbyCause"></unset>
          <unset token="faultsbyRule"></unset>
        </drilldown>
      </chart>
    </panel>
    <panel>
      <chart>
        <title>Top Faults by Rule</title>
        <search>
          <query>(index::666666-cli sourcetype::faultInfo) | search apic_ip_address=$apic_host$ severity=$multiTokenQuery$  | fields dn apic_ip_address rule | dedup dn,apic_ip_address | stats count(dn) by rule | head 10</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">pie</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.showDataLabels">none</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.layout.splitSeries.allowIndependentYRanges">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
        <option name="refresh.display">progressbar</option>
        <drilldown target="Help Desk Fault Detail">
          <set token="faultsbyRule">$click.value$</set>
          <unset token="faultsbyNode"></unset>
          <unset token="faultsbyTenant"></unset>
          <unset token="faultsbySeverity"></unset>
          <unset token="faultsbyDomain"></unset>
          <unset token="faultsbyCause"></unset>
          <unset token="faultsbyType"></unset>
        </drilldown>
      </chart>
    </panel>
    <panel>
      <chart>
        <title>Top Faults by Cause</title>
        <search>
          <query>(index::666666-cli sourcetype::faultInfo) | search apic_ip_address=$apic_host$ severity=$multiTokenQuery$  | fields dn apic_ip_address cause | dedup dn,apic_ip_address | stats count(dn) by cause | head 10</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">pie</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.showDataLabels">none</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.layout.splitSeries.allowIndependentYRanges">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
        <option name="refresh.display">progressbar</option>
        <drilldown target="Help Desk Fault Detail">
          <set token="faultsbyCause">$click.value$</set>
          <unset token="faultsbyNode"></unset>
          <unset token="faultsbyTenant"></unset>
          <unset token="faultsbySeverity"></unset>
          <unset token="faultsbyDomain"></unset>
          <unset token="faultsbyType"></unset>
          <unset token="faultsbyRule"></unset>
        </drilldown>
      </chart>
    </panel>
    <panel>
      <chart>
        <title>Faults by code</title>
        <search>
          <query>(index::666666-cli sourcetype::faultInfo) | search apic_ip_address=$apic_host$ severity=$multiTokenQuery$ | fields ack code affected dn apic_ip_address deviceId severity node | stats count(dn) by code</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">pie</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.showDataLabels">none</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.layout.splitSeries.allowIndependentYRanges">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
        <option name="charting.seriesColors">[0x08415C,0xCC2936,0xEBBAB9,0x388697,0xB5FFE1]</option>
        <option name="refresh.display">progressbar</option>
        <drilldown>
          <set token="faultsbyCode">$click.value$</set>
          <unset token="faultsbyTenant"></unset>
          <unset token="faultsbySeverity"></unset>
          <unset token="faultsbyDomain"></unset>
          <unset token="faultsbyCause"></unset>
          <unset token="faultsbyType"></unset>
          <unset token="faultsbyRule"></unset>
        </drilldown>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <table id="highlightfour" depends="$faultsbyType$">
        <title>Faults by Type Detail</title>
        <search>
          <query>(index::666666-cli sourcetype::faultInfo) | eval NPtime=_time+57600 | eval NPtime=strftime(NPtime, "%Y-%m-%d %H:%M:%S") | rename ack AS acknowledged | search type=$faultsbyType$ apic_ip_address=$apic_host$ severity=$multiTokenQuery$ | rex field=dn "^(?&lt;uni&gt;.+?)\/(?&lt;tenantid&gt;.+?)\/(?&lt;other&gt;\w+)" | rename tenantid AS tenantId descr AS description created AS timeStamp | fields code NPtime node tenantId deviceId severity type rule domain apic_ip_address timeStamp acknowledged cause description |  fields - _raw _time</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="count">10</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">true</option>
        <option name="wrap">true</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <table id="highlightfive" depends="$faultsbyRule$">
        <title>Faults by Rule Detail</title>
        <search>
          <query>(index::666666-cli sourcetype::faultInfo) | eval NPtime=_time+57600 | eval NPtime=strftime(NPtime, "%Y-%m-%d %H:%M:%S") | rename ack AS acknowledged | search rule=$faultsbyRule$ apic_ip_address=$apic_host$ severity=$multiTokenQuery$ | rex field=dn "^(?&lt;uni&gt;.+?)\/(?&lt;tenantid&gt;.+?)\/(?&lt;other&gt;\w+)" | rename tenantid AS tenantId descr AS description created AS timeStamp | fields code NPtime node tenantId deviceId severity type rule domain apic_ip_address timeStamp acknowledged cause description |  fields - _raw _time</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="count">10</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">true</option>
        <option name="wrap">true</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <table id="highlightsix" depends="$faultsbyCause$">
        <title>Faults by Cause Detail</title>
        <search>
          <query>(index::666666-cli sourcetype::faultInfo) | eval NPtime=_time+57600 | eval NPtime=strftime(NPtime, "%Y-%m-%d %H:%M:%S") | rename ack AS acknowledged | search  cause=$faultsbyCause$ apic_ip_address=$apic_host$ severity=$multiTokenQuery$ | rex field=dn "^(?&lt;uni&gt;.+?)\/(?&lt;tenantid&gt;.+?)\/(?&lt;other&gt;\w+)" | rename tenantid AS tenantId descr AS description created AS timeStamp | fields code NPtime node tenantId deviceId severity type rule cause domain apic_ip_address timeStamp acknowledged cause description |  fields - _raw _time</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="count">10</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">true</option>
        <option name="wrap">true</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <table id="highlightseven" depends="$faultsbyCode$">
        <title>Faults by Code Detail</title>
        <search>
          <query>(index::666666-cli sourcetype::faultInfo)| eval NPtime=_time+57600 | eval NPtime=strftime(NPtime, "%Y-%m-%d %H:%M:%S") | rename ack AS acknowledged | search code=$faultsbyCode$ apic_ip_address=$apic_host$ severity=$multiTokenQuery$ | rex field=dn "^(?&lt;uni&gt;.+?)\/(?&lt;tenantid&gt;.+?)\/(?&lt;other&gt;\w+)" | rename tenantid AS tenantId descr AS description created AS timeStamp | fields code NPtime node tenantId deviceId severity domain apic_ip_address timeStamp acknowledged cause description |  fields - _raw _time</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="count">10</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">true</option>
        <option name="wrap">false</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <chart>
        <title>Faults by Severity Over Time</title>
        <search>
          <query>(index::666666-cli sourcetype::faultInfo) | search apic_ip_address=$apic_host$ severity=$multiTokenQuery$ | timechart count by severity</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">area</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">connect</option>
        <option name="charting.chart.showDataLabels">none</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">none</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.layout.splitSeries.allowIndependentYRanges">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
        <option name="refresh.display">progressbar</option>
        <option name="charting.fieldColors">{"critical": 0x5100DC,major": 0xFF0000, "minor": 0xFFA500, "warning: 0xFFFF00, "cleared": 0x009900}</option>
      </chart>
    </panel>
  </row>
</form>